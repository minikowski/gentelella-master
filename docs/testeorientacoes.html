<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário de Orientação</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
      background-color: #f5f5f5;
    }

    h2 {
      color: #2c3e50;
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 10px;
      border-bottom: 1px solid #ddd;
    }

    h3 {
      color: #34495e;
      margin-top: 25px;
      padding-bottom: 5px;
      border-bottom: 1px solid #eee;
    }

    .form-container {
      background-color: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
      color: #2c3e50;
    }

    select, input, textarea {
      width: 100%;
      margin-top: 5px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    textarea {
      min-height: 80px;
      resize: vertical;
    }

    .topico {
      margin-top: 15px;
      background-color: #f9f9f9;
      padding: 15px;
      border-radius: 4px;
      border-left: 4px solid #3498db;
    }

    .participante-container {
      margin-bottom: 15px;
      padding: 15px;
      background-color: #f0f7ff;
      border-radius: 4px;
      border-left: 4px solid #2980b9;
    }

    button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 10px 15px;
      margin-top: 15px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #2980b9;
    }

    #gerar-pdf {
      background-color: #27ae60;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      margin-top: 25px;
    }

    #gerar-pdf:hover {
      background-color: #219653;
    }

    .input-group {
      display: flex;
      gap: 10px;
    }

    .input-group input {
      flex: 1;
    }

    .input-group select {
      width: auto;
      min-width: 200px;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2>ORIENTAÇÃO: ATENDIMENTO ADMINISTRATIVO/OPERACIONAL/APOIO</h2>

    <label for="nome">Nome do Colaborador:</label>
    <input id="nome" type="text" />

    <label for="cargo">Cargo:</label>
    <select id="cargo">
      <option>SUPERVISOR (A) PEDAGÓGICO (A)</option>
      <option>SUPERVISOR (A) DE UNIDADE</option>
      <option>SUPERVISOR (A) ADMINISTRATIVO (A)</option>
      <option>EDUCADOR (A) SOCIAL</option>
    </select>

    <label for="unidade">Unidade:</label>
    <select id="unidade">
      <option>CENTRAL</option>
      <option>CENTRO B</option>
      <option>CSU</option>
      <option>GUARAVERA</option>
      <option>LERROVILLE</option>
      <option>ELIVIVE</option>
    </select>

    <label for="assunto">Assuntos Tratados:</label>
    <textarea id="assunto">Orientação: Feedback – Período de Experiência</textarea>

    <h3>Participantes (além do colaborador):</h3>
    <div id="participantes">
      <div class="participante-container">
        <div class="input-group">
          <input placeholder="Nome do Participante" class="pnome" type="text" />
          <select class="pcargo">
            <option>COORDENADOR (A)</option>
            <option>SUPERVISOR (A) PEDAGÓGICO (A)</option>
            <option>SUPERVISOR (A) DE UNIDADE</option>
            <option>SUPERVISOR (A) ADMINISTRATIVO (A)</option>
            <option>EDUCADOR (A) SOCIAL</option>
          </select>
        </div>
      </div>
    </div>
    <button type="button" onclick="addParticipante()">Adicionar Participante</button>

    <h3>Assuntos (tópicos):</h3>
    <div id="topicos"></div>
    <button type="button" onclick="addTopico()">Adicionar Tópico</button>

    <button id="gerar-pdf" type="button" onclick="gerarPDF()">Gerar PDF</button>
  </div>

  <script>
    const opcoesTópicos = [
      "Pontualidade: o colaborador não cumpre o horário de entrada e/ou saída da entidade.",
      "Assiduidade: o colaborador não cumpre a carga horária definida e não justifica, quando necessária, a ausência/falta.",
      "Disciplina e Organização: o colaborador não cumpre o regimento interno, pacto de convivência e orientações voltadas para a efetividade do trabalho.",
      "Adaptação: o colaborador não se identifica com as atividades de seu cargo e/ou com as características da entidade, reagindo negativamente às mudanças necessárias.",
      "Relacionamento interpessoal: o colaborador não se comunica de forma positiva e tem dificuldades de relacionamento/convivência com superiores, colegas, educandos e seus familiares.",
      "Iniciativa: o colaborador não demonstra atitude proativa nem apresenta alternativas ou sugestões para a resolução de questões cotidianas ou melhorias nas atividades que desenvolve.",
      "Interesse: o colaborador não demonstra dedicação ou esforço pessoal em aperfeiçoar-se para assumir novas responsabilidades.",
      "Conhecimento: o colaborador não possui conhecimento teórico e/ou prático suficiente para a execução das atividades.",
      "Qualidade técnica: o colaborador não tem domínio dos processos, ferramentas ou habilidades necessárias ao desempenho das atividades.",
      "Postura ética: o colaborador não apresenta atitudes de idoneidade, cidadania ou integridade, comprometendo o respeito ao sigilo e o relacionamento com a entidade, colegas e educandos.",
      "Saúde e segurança: não tem conhecimento ou não age de maneira preventiva quanto às orientações sobre segurança no trabalho, podendo fazer uso inadequado dos equipamentos de proteção, quando necessário.",
      "Consumo consciente: não compreende a relevância de projetos de desenvolvimento sustentável e de consumo consciente, desperdiçando recursos materiais e alimentícios."
    ];

    function addParticipante() {
      const div = document.createElement('div');
      div.className = 'participante-container';
      div.innerHTML = `
        <div class="input-group">
          <input placeholder="Nome do Participante" class="pnome" type="text" />
          <select class="pcargo">
            <option>COORDENADOR (A)</option>
            <option>SUPERVISOR (A) PEDAGÓGICO (A)</option>
            <option>SUPERVISOR (A) DE UNIDADE</option>
            <option>SUPERVISOR (A) ADMINISTRATIVO (A)</option>
            <option>EDUCADOR (A) SOCIAL</option>
          </select>
        </div>
      `;
      document.getElementById('participantes').appendChild(div);
    }

    function addTopico() {
      const container = document.getElementById('topicos');
      const div = document.createElement('div');
      div.className = 'topico';
      div.innerHTML = `
        <textarea placeholder="Descreva o tópico (ou deixe em branco e selecione abaixo)"></textarea>
        <select onchange="this.previousElementSibling.value = this.value">
          <option value="">-- Selecionar tópico existente --</option>
          ${opcoesTópicos.map(op => `<option>${op}</option>`).join("")}
        </select>
      `;
      container.appendChild(div);
    }

    async function gerarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: "cm", format: "a4" });

      const fundo = await fetch('fundo.jpg').then(res => res.blob()).then(blob => {
        return new Promise(resolve => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result);
          reader.readAsDataURL(blob);
        });
      });

      doc.addImage(fundo, 'JPEG', 0, 0, 21, 29.7);
      doc.setFont("helvetica", "normal");
      doc.setFontSize(11);

      const nome = document.getElementById("nome").value;
      const cargo = document.getElementById("cargo").value;
      const unidade = document.getElementById("unidade").value;
      const assunto = document.getElementById("assunto").value;
      const participantes = Array.from(document.querySelectorAll(".pnome")).map((el, i) => ({
        nome: el.value,
        cargo: document.querySelectorAll(".pcargo")[i].value
      }));

      const topicos = Array.from(document.querySelectorAll(".topico textarea"))
        .map(el => el.value.trim()).filter(Boolean);

      let y = 4.5;

      doc.setFontSize(13);
      doc.setFont(undefined, "bold");
      doc.text("ATENDIMENTO ADMINISTRATIVO/ OPERACIONAL/ APOIO – ORIENTAÇÃO", 1.5, y);
      y += 1;

      doc.setFontSize(11);
      doc.setFont(undefined, "normal");
      
      // TEXTO DO COLABORADOR COM QUEBRA AUTOMÁTICA
      const colaboradorText = `Colaborador(a): ${nome} – CARGO: ${cargo} – UNIDADE: ${unidade}`;
      const colaboradorLines = doc.splitTextToSize(colaboradorText, 18);
      doc.text(colaboradorLines, 1.5, y);
      y += colaboradorLines.length * 0.5;
      
      doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, 1.5, y); y += 0.8;

      doc.text("Assuntos Tratados:", 1.5, y); y += 0.6;
      const assuntoLines = doc.splitTextToSize(assunto, 18);
      doc.text(assuntoLines, 1.5, y); y += assuntoLines.length * 0.5;

      doc.text("Participantes:", 1.5, y); y += 0.6;
      doc.text(`- ${nome}`, 1.5, y); y += 0.6;
      participantes.forEach(p => {
        const line = `- ${p.nome} – CARGO: ${p.cargo}`;
        const lines = doc.splitTextToSize(line, 18);
        doc.text(lines, 1.5, y);
        y += lines.length * 0.5;
      });

      y += 0.5;
      const alinhamentoText = `O(a) ${cargo} ${nome}, da unidade ${unidade}, é orientado(a) neste alinhamento a respeito dos seguintes assuntos:`;
      const alinhamentoLines = doc.splitTextToSize(alinhamentoText, 18);
      doc.text(alinhamentoLines, 1.5, y); y += alinhamentoLines.length * 0.5 + 0.5;

      let letra = 'a'.charCodeAt(0);
      topicos.forEach(t => {
        const texto = `${String.fromCharCode(letra++)}) ${t}`;
        const linhas = doc.splitTextToSize(texto, 18);
        doc.text(linhas, 1.5, y);
        y += linhas.length * 0.5;
      });

      y += 1;
      doc.text("Cientes:", 1.5, y); y += 0.7;

      const todos = [nome, ...participantes.map(p => p.nome)];
      for (let i = 0; i < todos.length; i += 2) {
        const nome1 = todos[i] || "";
        const nome2 = todos[i + 1] || "";
        doc.text("_____________________", 1.5, y);
        doc.text("_____________________", 11.5, y);
        y += 0.5;
        doc.text(nome1, 1.5, y);
        doc.text(nome2, 11.5, y);
        y += 0.8;
      }

      doc.save("orientacao.pdf");
    }
  </script>
</body>
</html>