<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário de Orientação</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }

    select, input, textarea {
      width: 100%;
      margin-top: 5px;
    }

    .topico {
      margin-top: 10px;
    }

    .topico-lista {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>ORIENTAÇÃO: ATENDIMENTO ADMINISTRATIVO/OPERACIONAL/APOIO</h2>

  <label>Nome do Colaborador:</label>
  <input id="nome" />

  <label>Cargo:</label>
  <select id="cargo">
    <option>SUPERVISÃO PEDAGÓGICA</option>
    <option>SUPERVISÃO DE UNIDADE</option>
    <option>SUPERVISÃO ADMINISTRATIVA</option>
    <option>EDUCADOR (A) SOCIAL</option>
  </select>

  <label>Unidade:</label>
  <select id="unidade">
    <option>CENTRAL</option>
    <option>CENTRO B</option>
    <option>CSU</option>
    <option>GUARAVERA</option>
    <option>LERROVILLE</option>
    <option>ELIVIVE</option>
  </select>

  <label>Assuntos Tratados:</label>
  <textarea id="assunto">1. Orientação: Feedback – Período de Experiência</textarea>

  <h3>Participantes (além do colaborador):</h3>
  <div id="participantes">
    <div>
      <input placeholder="Nome do Participante" class="pnome" />
      <select class="pcargo">
        <option>COORDENAÇÃO</option>
        <option>SUPERVISÃO PEDAGÓGICA</option>
        <option>SUPERVISÃO DE UNIDADE</option>
        <option>SUPERVISÃO ADMINISTRATIVA</option>
        <option>EDUCADOR (A) SOCIAL</option>
      </select>
    </div>
  </div>
  <button onclick="addParticipante()">Adicionar Participante</button>

  <h3>Assuntos (tópicos):</h3>
  <div id="topicos"></div>
  <button onclick="addTopico()">Adicionar Tópico</button>

  <br><br>
  <button onclick="gerarPDF()">Gerar PDF</button>

  <script>
    const opcoesTópicos = [
      "Pontualidade: o colaborador não cumpre o horário de entrada e/ou saída da entidade.",
      "Assiduidade: o colaborador não cumpre a carga horária definida e não justifica, quando necessária, a ausência/falta.",
      "Disciplina e Organização: o colaborador não cumpre o regimento interno, pacto de convivência e orientações voltadas para a efetividade do trabalho.",
      "Adaptação: o colaborador não se identifica com as atividades de seu cargo e/ou com as características da entidade, reagindo negativamente às mudanças necessárias.",
      "Relacionamento interpessoal: o colaborador não se comunica de forma positiva e tem dificuldades de relacionamento/convivência com superiores, colegas, educandos e seus familiares.",
      "Iniciativa: o colaborador não demonstra atitude proativa nem apresenta alternativas ou sugestões para a resolução de questões cotidianas ou melhorias nas atividades que desenvolve.",
      "Interesse: o colaborador não demonstra dedicação ou esforço pessoal em aperfeiçoar-se para assumir novas responsabilidades.",
      "Conhecimento: o colaborador não possui conhecimento teórico e/ou prático suficiente para a execução das atividades.",
      "Qualidade técnica: o colaborador não tem domínio dos processos, ferramentas ou habilidades necessárias ao desempenho das atividades.",
      "Postura ética: o colaborador não apresenta atitudes de idoneidade, cidadania ou integridade, comprometendo o respeito ao sigilo e o relacionamento com a entidade, colegas e educandos.",
      "Saúde e segurança: não tem conhecimento ou não age de maneira preventiva quanto às orientações sobre segurança no trabalho, podendo fazer uso inadequado dos equipamentos de proteção, quando necessário.",
      "Consumo consciente: não compreende a relevância de projetos de desenvolvimento sustentável e de consumo consciente, desperdiçando recursos materiais e alimentícios."
    ];

    function addParticipante() {
      const div = document.createElement('div');
      div.innerHTML = `
        <input placeholder="Nome do Participante" class="pnome" />
        <select class="pcargo">
          <option>COORDENAÇÃO</option>
          <option>SUPERVISÃO PEDAGÓGICA</option>
          <option>SUPERVISÃO DE UNIDADE</option>
          <option>SUPERVISÃO ADMINISTRATIVA</option>
          <option>EDUCADOR (A) SOCIAL</option>
        </select>
      `;
      document.getElementById('participantes').appendChild(div);
    }

    function addTopico() {
      const container = document.getElementById('topicos');
      const div = document.createElement('div');
      div.className = 'topico';
      div.innerHTML = `
        <textarea placeholder="Descreva o tópico (ou deixe em branco e selecione abaixo)"></textarea>
        <select onchange="this.previousElementSibling.value = this.value">
          <option value="">-- Selecionar tópico existente --</option>
          ${opcoesTópicos.map(op => `<option>${op}</option>`).join("")}
        </select>
      `;
      container.appendChild(div);
    }

    async function gerarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: "cm", format: "a4" });

      const fundo = await fetch('fundo.jpg').then(res => res.blob()).then(blob => {
        return new Promise(resolve => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result);
          reader.readAsDataURL(blob);
        });
      });

      doc.addImage(fundo, 'JPEG', 0, 0, 21, 29.7);

      const nome = document.getElementById("nome").value;
      const cargo = document.getElementById("cargo").value;
      const unidade = document.getElementById("unidade").value;
      const assunto = document.getElementById("assunto").value;
      const participantes = Array.from(document.querySelectorAll(".pnome")).map((el, i) => ({
        nome: el.value,
        cargo: document.querySelectorAll(".pcargo")[i].value
      }));

      const topicos = Array.from(document.querySelectorAll(".topico textarea"))
        .map(el => el.value.trim()).filter(Boolean);

      let y = 2.5;
      doc.setFont("Arial", "bold");
      doc.setFontSize(13);
      doc.text(`ATENDIMENTO ADMINISTRATIVO/ OPERACIONAL/ APOIO – ORIENTAÇÃO`, 1.5, y);
      y += 1;

      doc.setFontSize(11);
      doc.setFont("Arial", "normal");
      doc.text(`Colaborador(a): ${nome} – CARGO: ${cargo} – UNIDADE: ${unidade}`, 1.5, y); y += 0.8;
      doc.text(`Data: ${new Date().toLocaleDateString('pt-BR')}`, 1.5, y); y += 0.8;

      doc.text(`Assuntos Tratados:`, 1.5, y); y += 0.6;
      const assuntoLines = doc.splitTextToSize(assunto, 18);
      doc.text(assuntoLines, 1.5, y); y += assuntoLines.length * 0.5;

      doc.text(`Participantes:`, 1.5, y); y += 0.6;
      doc.text(`- ${nome}`, 1.5, y); y += 0.6;
      participantes.forEach(p => {
        doc.text(`- ${p.nome} – CARGO: ${p.cargo}`, 1.5, y);
        y += 0.6;
      });

      y += 0.5;
      doc.text(`O(a) ${cargo} ${nome}, da unidade ${unidade}, é orientado(a) neste alinhamento a respeito dos seguintes assuntos:`, 1.5, y); y += 0.8;

      let letra = 'a'.charCodeAt(0);
      topicos.forEach(t => {
        const prefix = String.fromCharCode(letra++) + ') ';
        const linhas = doc.splitTextToSize(prefix + t, 18);
        doc.text(linhas, 1.5, y);
        y += linhas.length * 0.5;
      });

      y += 1;
      doc.text("Cientes:", 1.5, y); y += 1;

      for (let i = 0; i < 4; i += 2) {
        const p1 = participantes[i]?.nome || "______________________";
        const p2 = participantes[i + 1]?.nome || "______________________";
        doc.text(p1, 1.5, y);
        doc.text(p2, 11.5, y);
        y += 0.6;
      }

      doc.save("orientacao.pdf");
    }
  </script>
</body>
</html>
