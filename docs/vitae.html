<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário de Currículo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f0f0f0;
    }

    .container {
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 20px;
    }

    form {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .form-group {
      flex: 1 1 45%;
      display: flex;
      flex-direction: column;
    }

    label {
      margin-bottom: 5px;
      font-weight: bold;
    }

    input, textarea, select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .full-width {
      flex: 1 1 100%;
    }

    .photo-preview {
      position: absolute;
      top: 1.95cm;
      left: 2.32cm;
      width: 7.05cm;
      height: 7.05cm;
      border-radius: 50%;
      overflow: hidden;
      z-index: 2;
    }

    .photo-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #preview {
      position: relative;
      width: 100%;
      max-width: 800px;
    }

    #template {
      width: 100%;
    }

    button {
      padding: 10px 20px;
      background-color: #f57c00;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Gerador de Currículo</h1>
    <form id="cvForm">
      <div class="form-group">
        <label for="nome">Nome Completo</label>
        <input type="text" id="nome" name="nome" required>
      </div>
      <div class="form-group">
        <label for="objetivo">Objetivo</label>
        <textarea id="objetivo" name="objetivo"></textarea>
      </div>
      <div class="form-group">
        <label for="telefone">Telefone</label>
        <input type="text" id="telefone" name="telefone">
      </div>
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email">
      </div>
      <div class="form-group">
        <label for="endereco">Endereço</label>
        <textarea id="endereco" name="endereco"></textarea>
      </div>
      <div class="form-group">
        <label for="formacao">Formação Acadêmica</label>
        <textarea id="formacao" name="formacao"></textarea>
      </div>
      <div class="form-group">
        <label for="cursos">Cursos Complementares</label>
        <textarea id="cursos" name="cursos"></textarea>
      </div>
      <div class="form-group">
        <label for="habilidades">Habilidades e Competências</label>
        <textarea id="habilidades" name="habilidades"></textarea>
      </div>
      <div class="form-group">
        <label for="experiencia">Experiência Profissional</label>
        <textarea id="experiencia" name="experiencia"></textarea>
      </div>
      <div class="form-group full-width">
        <label for="foto">Foto de Perfil</label>
        <input type="file" id="foto" accept="image/*">
      </div>
      <div class="form-group full-width">
        <button type="button" onclick="gerarPDF()">Gerar PDF</button>
      </div>
    </form>

    <div id="preview">
      <img id="template" src="template.jpg" alt="Template de fundo">
      <div class="photo-preview" id="previewPhoto"></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const fotoInput = document.getElementById('foto');
    const previewPhoto = document.getElementById('previewPhoto');

    fotoInput.addEventListener('change', function () {
      const file = fotoInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          previewPhoto.innerHTML = `<img src="${e.target.result}" alt="Foto">`;
        };
        reader.readAsDataURL(file);
      }
    });

    async function gerarPDF() {
      const {{ jsPDF }} = window.jspdf;
      const doc = new jsPDF({ orientation: 'portrait', unit: 'cm', format: 'a4' });

      const template = await fetch('template.jpg').then(r => r.blob());
      const reader = new FileReader();
      reader.onload = function (e) {
        const imgData = e.target.result;

        doc.addImage(imgData, 'JPEG', 0, 0, 21, 29.7);

        // Exemplo de posicionamento
        doc.setFontSize(20);
        doc.setTextColor('#000000');
        doc.text(document.getElementById('nome').value, 11, 3);

        doc.setFontSize(12);
        doc.setTextColor('#f57c00');
        doc.text('Objetivo', 11, 5);

        doc.setTextColor('#000000');
        doc.text(doc.splitTextToSize(document.getElementById('objetivo').value, 9), 11, 5.7);

        // Continue com os demais campos em posições conforme o layout

        doc.save('curriculo.pdf');
      };
      reader.readAsDataURL(template);
    }
  </script>
</body>
</html>